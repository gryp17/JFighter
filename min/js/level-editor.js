function LevelEditor(e){var t=this;this.container=e,this.backgroundContainer=this.container.find(".background-container"),this.controlsContainer=this.container.find(".controls-container"),this.controls=this.container.find(".controls"),this.canvasHeight=620,this.backgroundImageHeight=this.backgroundContainer.height(),this.heightOffset=this.backgroundImageHeight-this.canvasHeight,this.dragging=!1,this.draggedObject,this.groundObjects={Sherman:{groundDistance:10},Civilian:{groundDistance:24}},this.groundHeight=40,this.init=function(){this.backgroundContainer.on("mousewheel",t.scrollBackground),$(".theme").change(t.setLevelTheme),this.controls.find(".game-object").mousedown(t.addGameObject),$("body").on("mousedown",".background-container .game-object",t.selectGameObject),$("body").mouseup(t.dropGameObject),this.container.mousemove(t.dragGameObject),$(".save-level-button").click(t.saveLevel)},this.setLevelTheme=function(){var e=$(this).val(),n="img/levels/",a=".jpg";t.backgroundContainer.css({backgroundImage:"url("+n+e+a+")"})},this.scrollBackground=function(e){var t=$(document).scrollLeft();$(document).scrollLeft(t+40*e.deltaY),e.preventDefault()},this.addGameObject=function(e){t.draggedObject=$(this).clone(),t.draggedObject.css({position:"absolute"}),t.draggedObject.css({top:e.pageY,left:e.pageX}),$("body").append(t.draggedObject),t.dragging=!0,e.preventDefault()},this.selectGameObject=function(e){t.draggedObject=$(this),t.dragging=!0,e.preventDefault()},this.dropGameObject=function(e){if(t.dragging){if(e.pageY>t.backgroundContainer.height())return;var n=e.pageY,a=e.pageX;if(t.groundObjects[t.draggedObject.attr("data-object")]){var o=t.groundObjects[t.draggedObject.attr("data-object")];n=t.backgroundImageHeight-o.groundDistance-t.draggedObject.height()}if(t.draggedObject.css({top:n,left:a}),!t.draggedObject.has(".remove-btn").length){var i=$("<img>",{"class":"remove-btn",src:"img/level-editor/icon-remove.png",title:"Remove",click:function(e){$(this).closest(".game-object").remove(),t.draggedObject=null,t.dragging=!1,e.stopPropagation()}});t.draggedObject.append(i)}t.draggedObject.appendTo(t.backgroundContainer),t.draggedObject=null,t.dragging=!1}},this.dragGameObject=function(e){t.dragging&&t.draggedObject.css({top:e.pageY,left:e.pageX})},this.saveLevel=function(){var e=[],n=t.backgroundContainer.find(".game-object");n.each(function(){var n=$(this),a=n.offset(),o=a.left,i=a.top;i-=t.heightOffset,e.push({objectType:n.attr("data-object"),arguments:{x:o,y:i}})}),console.log(e)}}var editor=new LevelEditor($("#container"));editor.init();