function Background(t){this.context=t.contexts.background.context,this.canvas=t.contexts.background.canvas,this.backgroundImage=t.images.LEVELS[t.selectedLevel],this.dx=-2,this.x=0,this.dy=0,this.y=this.canvas.height-this.backgroundImage.height,this.offset=0,this.draw=function(){this.x=this.x+this.dx,this.y=this.y+this.dy,this.x<-1*this.backgroundImage.width&&(this.x=0),this.moveBackgroundVertically(t.plane),this.y>0&&(this.dy=0,this.y=0),this.y<-1*(this.backgroundImage.height-this.canvas.height)&&(this.dy=0,this.y=-1*(this.backgroundImage.height-this.canvas.height));var i=this.canvas.height-this.backgroundImage.height;this.offset=this.y-i,this.context.drawImage(this.backgroundImage,this.x,this.y),this.context.drawImage(this.backgroundImage,this.x+this.backgroundImage.width,this.y)},this.moveBackgroundVertically=function(t){if(0!==t.dy){var i=this.canvas.height/2;t.y<i&&t.dy<0?this.dy=-1.3*t.dy:t.dy>0&&(this.dy=-1.3*t.dy)}else this.dy=0}}function BulletImpact(t,i,e){this.context=t.contexts.plane.context,this.canvas=t.contexts.plane.canvas,this.impactImages=t.images.BULLET_IMPACT,this.active=!0,this.dx=0,this.x=i,this.dy=0,this.y=e,this.impactSprite=new Sprite(this.impactImages,5,!1),this.currentImage,this.draw=function(){this.x=this.x+this.dx,this.y=this.y+this.dy,this.updateSprite(),this.active&&this.context.drawImage(this.currentImage,this.x,this.y+t.background.offset)},this.updateSprite=function(){this.currentImage=this.impactSprite.move(),null===this.currentImage&&(this.active=!1)}}function Civilian(t,i,e){this.context=t.contexts.enemies.context,this.canvas=t.contexts.enemies.canvas,this.images=t.images.CIVILIAN,this.dx=-2.5,this.x=i,this.dy=0,this.y=e,this.active=!0,this.dead=!1,this.sprite=new Sprite(this.images.SPRITE,7,!0),this.currentImage=this.images.SPRITE[0],this.draw=function(){this.updateSprite(),this.x=this.x+this.dx,this.y=this.y+this.dy,this.context.drawImage(this.currentImage,this.x,this.y+t.background.offset)},this.updateSprite=function(){this.dead===!1&&(this.currentImage=this.sprite.move())},this.die=function(){this.dead=!0,this.y=580,this.dx=-2,this.currentImage=this.images.DEAD},this.getHitbox=function(){return{x:this.x,y:this.y,width:this.currentImage.width,height:this.currentImage.height,offset:t.background.offset}}}function Explosion(t,i,e,s,n,h){this.context=t.contexts.plane.context,this.canvas=t.contexts.plane.canvas,this.explosionImages=t.images.EXPLOSION,this.bombHole=t.images.BOMB_HOLE,this.dx=s,this.x=i,this.dy=n,this.y=e,this.sprite=new Sprite(this.explosionImages,5,!1),this.currentImage,this.active=!0,this.showBombHole=h,this.draw=function(){this.updateSprite(),this.active&&(this.x=this.x+this.dx,this.y=this.y+this.dy,this.x+this.currentImage.width<0&&(this.active=!1),this.context.drawImage(this.currentImage,this.x,this.y+t.background.offset))},this.updateSprite=function(){this.currentImage=this.sprite.move(),null===this.currentImage&&(this.showBombHole?this.currentImage=this.bombHole:this.active=!1)}}function PlaneBomb(t,i,e,s,n){this.context=t.contexts.plane.context,this.canvas=t.contexts.plane.canvas,this.bombImages=t.images.PROJECTILES.PLANE_BOMB,this.explosionImages=t.images.EXPLOSION,this.dx=s,this.x=i,this.dy=n,this.y=e,this.explosionRadius=t.plane.stats.BOMB_EXPLOSION_RADIUS,this.sprite=new Sprite(this.bombImages,10,!0),this.currentImage,this.active=!0,this.draw=function(){this.updateSprite(),this.x=this.x+this.dx,this.y=this.y+this.dy,this.context.drawImage(this.currentImage,this.x,this.y+t.background.offset)},this.explode=function(i){this.active=!1;var e=this.x-this.explosionImages[0].width/3,s=this.y+this.currentImage.height-this.explosionImages[0].height;t.explosions.push(new Explosion(t,e,s,-2,0,i))},this.updateSprite=function(){this.currentImage=this.sprite.move()},this.getHitbox=function(){return{x:this.x,y:this.y,width:this.currentImage.width,height:this.currentImage.height,offset:t.background.offset}},this.getExplosionHitbox=function(){var t=this.getHitbox();return t.x=t.x-this.explosionRadius,t.width=t.width+this.explosionRadius,t}}function PlaneBullet(t,i,e,s,n,h){this.context=t.contexts.plane.context,this.canvas=t.contexts.plane.canvas,this.currentImage=t.images.PROJECTILES.BULLET,this.active=!0,this.damage=t.plane.stats.DAMAGE,this.dx=s,this.x=i,this.dy=n,this.y=e,this.angle=h,this.draw=function(){this.x=this.x+this.dx,this.y=this.y+this.dy,this.context.save(),this.context.translate(this.x+this.currentImage.width/2,this.y+this.currentImage.height/2),this.context.rotate(this.angle*Math.PI/180),this.context.drawImage(this.currentImage,-(this.currentImage.width/2),-(this.currentImage.height/2)+t.background.offset),this.context.restore()},this.explode=function(){this.active=!1,t.bulletImpacts.push(new BulletImpact(t,this.x+this.currentImage.width,this.y))},this.getHitbox=function(){return{x:this.x,y:this.y,width:this.currentImage.width,height:this.currentImage.height,offset:t.background.offset}}}function Plane(t){this.context=t.contexts.plane.context,this.canvas=t.contexts.plane.canvas,this.stats=t.planeStats[t.selectedPlane],this.images=t.images.PLANES[t.selectedPlane],this.health=this.stats.HEALTH,this.disabled=!1,this.crashed=!1,this.dx=1,this.x=200,this.dy=0,this.y=350,this.angle=0,this.sprite=new Sprite(this.images.SPRITE,2,!0),this.currentImage=this.images.SPRITE[0],this.shooting=!1,this.overheat=!1,this.bulletDelay=5,this.bulletTimer=0,this.machinegunHeat=0,this.bullets=[],this.bombing=!1,this.bombCooldown=this.stats.BOMB_COOLDOWN,this.bombDelay=this.stats.BOMB_DELAY,this.loadedBombs=this.stats.MAX_BOMBS,this.bombTimer=0,this.delayTimer=0,this.bombs=[],this.draw=function(){this.health<=0&&this.crashed===!1&&(this.disabled=!0,this.dy=2),this.disabled===!1&&this.processInputs(t.inputs),this.updateSprite(),this.updateMachinegunStatus(),this.updateBombsStatus(),this.x=this.x+this.dx,this.y=this.y+this.dy,this.drawPlane(),this.drawBullets(),this.drawBombs()},this.processInputs=function(t){t.UP&&this.dy>-3&&(this.dy=this.dy-.1),t.DOWN&&this.dy<3&&(this.dy=this.dy+.1),t.LEFT&&this.dx>-1&&(this.dx=this.dx-.1),t.RIGHT&&this.dx<this.stats.MAX_SPEED&&(this.dx=this.dx+.1),t.SHOOT&&this.shoot(),t.BOMB&&this.dropBomb()},this.updateSprite=function(){this.crashed===!0?this.currentImage=this.images.CRASHED:this.currentImage=this.sprite.move()},this.drawPlane=function(){this.dy>0?this.angle=this.dy*this.stats.DESCEND_SPEED:this.dy<0?this.angle=this.dy*this.stats.CLIMB_SPEED:this.angle=0,this.context.clearRect(0,0,this.canvas.width,this.canvas.height),this.context.save(),this.context.translate(this.x+this.currentImage.width/2,this.y+this.currentImage.height/2),this.context.rotate(this.angle*Math.PI/180),this.context.drawImage(this.currentImage,-(this.currentImage.width/2),-(this.currentImage.height/2)),this.context.restore()},this.updateMachinegunStatus=function(){this.machinegunHeat===this.stats.MAX_MACHINEGUN_HEAT&&(this.overheat=!0),this.machinegunHeat>0&&(this.machinegunHeat--,this.overheat&&0===this.machinegunHeat&&(this.overheat=!1)),this.shooting===!0&&(this.bulletTimer++,this.machinegunHeat=this.machinegunHeat+this.stats.MACHINEGUN_HEATING,this.machinegunHeat>this.stats.MAX_MACHINEGUN_HEAT&&(this.machinegunHeat=this.stats.MAX_MACHINEGUN_HEAT),this.bulletTimer>this.bulletDelay&&(this.shooting=!1,this.bulletTimer=0))},this.updateBombsStatus=function(){this.loadedBombs<this.stats.MAX_BOMBS&&(this.bombTimer++,this.delayTimer++,this.delayTimer>this.bombDelay&&(this.bombing=!1,this.delayTimer=0),this.bombTimer>this.bombCooldown&&(this.loadedBombs++,this.bombTimer=0))},this.drawBullets=function(){this.bullets=_.filter(this.bullets,function(t){return t.active===!1?!1:(t.draw(),!0)})},this.drawBombs=function(){this.bombs=_.filter(this.bombs,function(t){return t.active?(t.draw(),!0):!1})},this.shoot=function(){if(this.shooting===!1&&this.overheat===!1){var i=this.x+this.currentImage.width/2,e=this.y-t.background.offset+this.currentImage.height/2,s=25,n=0,h=this.angle;this.shooting=!0,this.dy>0?(h=this.dy*this.stats.DESCEND_SPEED,n=this.dy*(h/4.5)):this.dy<0&&(h=this.dy*this.stats.CLIMB_SPEED,n=this.dy*(h/4.5)*-1),"KI84"===t.selectedPlane&&-20>=h&&t.background.offset>0&&(i-=t.background.offset/2.5,e-=t.background.offset/7),this.bullets.push(new PlaneBullet(t,i,e,s,n,h))}},this.dropBomb=function(){if(this.loadedBombs>0&&this.bombing===!1){this.bombing=!0,this.loadedBombs--;var i=this.x+this.currentImage.width/1.3,e=this.y-t.background.offset+this.currentImage.height/2,s=this.dx-2,n=(this.dy>0?this.dy:0)+3;this.bombs.push(new PlaneBomb(t,i,e,s,n))}},this.getHitbox=function(){return{x:this.x,y:this.y,width:this.currentImage.width,height:this.currentImage.height,offset:0}}}function CollisionsManager(t){var i=this;this.handleCollisions=function(){this.handlePlane(),this.handleBombers(),this.handleCivilians()},this.handlePlane=function(){var i=t.plane,e=i.getHitbox(),s=_.filter(t.enemies,function(t){return t.constructor===Bomber});i.y<0&&(i.y=0,i.dy=0),i.x<0&&i.crashed===!1&&(i.x=0,i.dx=0),i.x+i.currentImage.width>i.canvas.width&&(i.x=i.canvas.width-i.currentImage.width,i.dx=-1),i.y+i.currentImage.height>i.canvas.height-40&&(i.y=i.canvas.height-i.currentImage.height-40,i.dy=0,i.dx=-2,i.disabled=!0,i.crashed=!0,i.health=0),s.forEach(function(t){t.bombs.forEach(function(t){Utils.collidesWith(e,t.getHitbox())&&(t.explode(!1),i.disabled=!0,i.health=0)})}),this.handlePlaneBullets(),this.handlePlaneBombs()},this.handlePlaneBullets=function(){t.plane.bullets.forEach(function(t){t.y>=t.canvas.height-30&&t.explode(),t.x>t.canvas.width&&(t.active=!1)})},this.handlePlaneBombs=function(){t.plane.bombs.forEach(function(t){t.x+t.currentImage.width<0&&(t.active=!1),t.y+t.currentImage.height>t.canvas.height-15&&t.explode(!0)})},this.handleBomberBombs=function(i){i.bombs.forEach(function(i){i.x+i.currentImage.width<0&&(i.active=!1),i.y+i.currentImage.height>i.canvas.height-15&&i.explode(!0),t.plane.bullets.forEach(function(t){Utils.collidesWith(i.getHitbox(),t.getHitbox())&&(t.explode(),i.explode(!1))})})},this.handleBombers=function(){var e=_.filter(t.enemies,function(t){return t.constructor===Bomber}),s=t.plane.getHitbox();e.forEach(function(e){var n=e.getHitbox();i.handleBomberBombs(e),e.y+e.currentImage.height>e.canvas.height-40&&(e.y=e.canvas.height-e.currentImage.height-40,e.dy=0,e.dx=-2,e.disabled=!0,e.crashed=!0),Utils.collidesWith(n,s)&&(e.health--,t.plane.health=t.plane.health-2),t.plane.bullets.forEach(function(t){var i=Utils.collidesWith(n[0],t.getHitbox()),s=Utils.collidesWith(n[1],t.getHitbox());if(i||s){var h=s?2*t.damage:t.damage;e.health=e.health-h,t.explode()}}),t.plane.bombs.forEach(function(t){Utils.collidesWith(n,t.getHitbox())&&(t.explode(!1),e.disabled=!0,e.health=0)})})},this.handleCivilians=function(){var i=_.filter(t.enemies,function(t){return t.constructor===Bomber});t.civilians.forEach(function(e){var s=e.getHitbox();e.x+e.currentImage.width<0&&(e.active=!1);var n=t.plane.bombs;i.forEach(function(t){n=n.concat(t.bombs)}),n.forEach(function(t){Utils.collidesWith(s,t.getExplosionHitbox())&&t.active===!1&&e.die()}),t.plane.bullets.forEach(function(t){Utils.collidesWith(s,t.getHitbox())&&(t.explode(),e.die())})})}}function Context(t){this.canvas=document.getElementById(t),this.context=this.canvas.getContext("2d")}function HUD(t,i){this.visible=!1,this.maxHue=130,this.maxPitchHue=200,this.show=function(){this.visible=!0},this.hide=function(){this.visible=!1},this.draw=function(){i.css("display",this.visible?"block":"none"),this.visible&&(this.drawHealth(),this.drawThrottle(),this.drawPitch(),this.drawHeat(),this.drawLoadedBombs())},this.drawHealth=function(){var e=t.plane.health,s=t.planeStats[t.selectedPlane].HEALTH,n=i.find(".health-bar"),h=n.find(".current"),a=n.width()/s,o=this.maxHue/s;h.css({backgroundColor:"hsl("+o*e+", 70%, 50%)",width:e*a})},this.drawThrottle=function(){var e=t.plane.dx+1,s=t.planeStats[t.selectedPlane].MAX_SPEED+1,n=i.find(".throttle-bar"),h=n.find(".current"),a=n.width()/s,o=this.maxHue/s,r=this.maxHue-o*e;h.css({backgroundColor:"hsl("+r+", 70%, 50%)",width:e*a})},this.drawPitch=function(){var e,s=t.plane.dy+3,n=6,h=i.find(".pitch-bar"),a=h.find(".current"),o=h.height()/n,r=this.maxPitchHue/n;e=s>=n/2?this.maxPitchHue-r*s:r*s,a.css({backgroundColor:"hsl("+e+", 70%, 50%)",height:h.height()-s*o})},this.drawHeat=function(){var e=t.plane.machinegunHeat,s=t.planeStats[t.selectedPlane].MAX_MACHINEGUN_HEAT,n=i.find(".heat-bar"),h=n.find("span"),a=n.find(".current"),o=t.plane.overheat?"OVERHEAT":"MACHINEGUN HEAT",r=n.width()/s,c=this.maxHue/s,g=this.maxHue-c*e;a.css({backgroundColor:"hsl("+g+", 70%, 50%)",width:e*r}),h.html(o)},this.drawLoadedBombs=function(){var e=t.plane.loadedBombs,s=t.plane.stats.MAX_BOMBS,n=i.find(".loaded-bombs");n.empty();for(var h=0;s>h;h++){var a=$("<img>",{src:"img/hud/bomb_icon.png","class":e>=h+1?"loaded":""});n.append(a)}}}function ImageRepository(t,i){function e(t){_.forOwn(t,function(t,i){"string"==typeof t?n.totalImages++:e(t)})}function s(t){_.forOwn(t,function(e,h){"string"==typeof e?(t[h]=new Image,t[h].src=e,t[h].onload=function(){n.loadedImages++,n.loadedImages===n.totalImages&&i()}):s(e)})}var n=this;this.images=t,this.loadedImages=0,this.totalImages=0,e(this.images),s(this.images)}function Keyboard(t){var i=this;t?this.inputs=t:this.inputs={LEFT:{status:!1,keys:[37,65]},RIGHT:{status:!1,keys:[39,68]},UP:{status:!1,keys:[38,87]},DOWN:{status:!1,keys:[40,83]},SHOOT:{status:!1,keys:[32]},BOMB:{status:!1,keys:[16]}},this.getInputs=function(){var t={};return _.forOwn(i.inputs,function(i,e){t[e]=i.status}),t},this.listen=function(){$("body").keydown(function(t){_.forOwn(i.inputs,function(i,e){_.includes(i.keys,t.which)&&(i.status=!0)})}),$("body").keyup(function(t){_.forOwn(i.inputs,function(i,e){_.includes(i.keys,t.which)&&(i.status=!1)})})}}function Menu(){var t=this;this.selectedPlane=null,this.selectedLevel=null,this.showMenu=function(i){$(".uil-ring-css").fadeOut(300,function(){$("#main-menu").fadeIn(300)}),$("#main-menu .plane").click(function(){t.selectedPlane=$(this).attr("data-plane"),$("#main-menu .select-plane").fadeOut(100,function(){$("#main-menu .select-level").fadeIn(100)})}),$("#main-menu .level").click(function(){t.selectedLevel=$(this).attr("data-level"),$("#main-menu").fadeOut(300,function(){$(".canvas").fadeIn(300)}),i(t.selectedPlane,t.selectedLevel)})}}function Sprite(t,i,e){this.images=t,this.delay=i,this.loop=e,this.index=0,this.frames=0,this.currentImage=this.images[this.index],this.move=function(){return this.loop||this.index!==this.images.length-1?(this.frames++,this.frames>this.delay&&(this.index++,_.isUndefined(this.images[this.index])&&(this.index=0),this.currentImage=this.images[this.index],this.frames=0),this.currentImage):(this.currentImage=null,this.currentImage)}}function BomberBomb(t,i,e,s,n){this.context=t.contexts.enemies.context,this.canvas=t.contexts.enemies.canvas,this.bombImages=t.images.PROJECTILES.BOMBER_BOMB,this.explosionImages=t.images.EXPLOSION,this.dx=s,this.x=i,this.dy=n,this.y=e,this.explosionRadius=t.enemyStats.B17.BOMB_EXPLOSION_RADIUS,this.sprite=new Sprite(this.bombImages,10,!0),this.currentImage,this.active=!0,this.draw=function(){this.updateSprite(),this.x=this.x+this.dx,this.y=this.y+this.dy,this.context.drawImage(this.currentImage,this.x,this.y+t.background.offset)},this.explode=function(i){this.active=!1;var e=this.x-this.explosionImages[0].width/3,s=this.y+this.currentImage.height-this.explosionImages[0].height;t.explosions.push(new Explosion(t,e,s,-2,0,i))},this.updateSprite=function(){this.currentImage=this.sprite.move()},this.getHitbox=function(){return{x:this.x,y:this.y,width:this.currentImage.width,height:this.currentImage.height,offset:t.background.offset}},this.getExplosionHitbox=function(){var t=this.getHitbox();return t.x=t.x-this.explosionRadius,t.width=t.width+this.explosionRadius,t}}function Bomber(t,i,e){this.context=t.contexts.enemies.context,this.canvas=t.contexts.enemies.canvas,this.images=t.images.ENEMIES.B17,this.stats=t.enemyStats.B17,this.health=this.stats.HEALTH,this.disabled=!1,this.crashed=!1,this.dx=-3,this.x=i,this.dy=0,this.y=e,this.angle=0,this.bombing=!1,this.bombCarpetSize=this.stats.BOMB_CARPET_SIZE,this.bombCooldown=this.stats.BOMB_COOLDOWN,this.bombTimer=0,this.bombs=[],this.sprite=new Sprite(this.images.SPRITE,2,!0),this.currentImage=this.images.SPRITE[0],this.draw=function(){this.health<=0&&this.crashed===!1&&(this.disabled=!0,this.dy=2),this.updateSprite(),this.x=this.x+this.dx,this.y=this.y+this.dy,this.disabled===!1&&this.avoidFighters(),this.dropBombs(),this.drawBomber(),this.drawBombs()},this.drawBomber=function(){this.dy>0?this.angle=-1*this.dy:this.dy<0?this.angle=-1*this.dy:this.angle=0,this.context.save(),this.context.translate(this.x+this.currentImage.width/2,this.y+t.background.offset+this.currentImage.height/2),this.context.rotate(this.angle*Math.PI/180),this.context.drawImage(this.currentImage,-(this.currentImage.width/2),-(this.currentImage.height/2)),this.context.restore()},this.drawBombs=function(){this.bombs=_.filter(this.bombs,function(t){return t.active?(t.draw(),!0):!1})},this.updateSprite=function(){this.crashed===!0?this.currentImage=this.images.CRASHED:this.currentImage=this.sprite.move()},this.getHitbox=function(){var i={x:this.x,y:this.y+this.currentImage.height/2,width:this.currentImage.width,height:this.currentImage.height/2,offset:t.background.offset},e={x:this.x+270,y:this.y,width:55,height:this.currentImage.height/2,offset:t.background.offset};return[i,e]},this.avoidFighters=function(){var i=this.x-t.plane.x+t.plane.currentImage.width,e=this.y+t.background.offset+this.currentImage.height-t.plane.y;i>0&&i<this.canvas.width-300&&e>-100?this.dy=-1:this.dy=0},this.dropBombs=function(){if(this.bombing===!0&&(this.bombTimer++,this.bombTimer>this.bombCooldown&&(this.bombing=!1,this.bombTimer=0)),this.x<this.canvas.width&&this.disabled===!1){var i=_.filter(this.bombs,{active:!0});if(this.bombing===!1&&i.length<this.bombCarpetSize){var e=this.x+this.currentImage.width/1.5,s=this.y+this.currentImage.height-25,n=this.dx+1,h=2;this.bombing=!0,this.bombs.push(new BomberBomb(t,e,s,n,h))}}}}function Game(t,i,e,s){var n=this;this.images=t,this.planeStats=i,this.enemyStats=e,this.levelsData=s,this.selectedPlane,this.selectedLevel,this.inputs,this.keyboard=new Keyboard,this.collisionsManager=new CollisionsManager(this),this.HUD=new HUD(this,$("#HUD")),this.contexts={background:new Context("background-canvas"),plane:new Context("plane-canvas"),enemies:new Context("enemies-canvas")},this.start=function(t,i){this.selectedPlane=t,this.selectedLevel=i,this.contexts.background.canvas.focus(),this.background=new Background(this),this.plane=new Plane(this),this.bulletImpacts=[],this.explosions=[],this.enemies=this.levelsData[i].ENEMIES.map(function(t){var arguments=[null,n],i=Object.values(t.arguments);return arguments=arguments.concat(i),new(Function.prototype.bind.apply(this[t.objectType],arguments))}),this.civilians=this.levelsData[i].CIVILIANS.map(function(t){var arguments=[null,n],i=Object.values(t.arguments);return arguments=arguments.concat(i),new(Function.prototype.bind.apply(this[t.objectType],arguments))}),this.keyboard.listen(),this.HUD.show(),this.animate()},this.animate=function(){requestAnimFrame(n.animate),n.inputs=n.keyboard.getInputs(),n.collisionsManager.handleCollisions(),n.background.draw(),n.plane.draw(),n.contexts.enemies.context.clearRect(0,0,n.contexts.enemies.canvas.width,n.contexts.enemies.canvas.height),n.enemies=_.filter(n.enemies,function(t){return t.x>-800?(t.draw(),!0):!1}),n.civilians=_.filter(n.civilians,function(t){return t.active?(t.draw(),!0):!1}),n.bulletImpacts=_.filter(n.bulletImpacts,function(t){return t.active?(t.draw(),!0):!1}),n.explosions=_.filter(n.explosions,function(t){return t.active?(t.draw(),!0):!1}),n.HUD.draw()},window.requestAnimFrame=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(t,i){window.setTimeout(t,1e3/60)}}()}var ENEMY_STATS={B17:{HEALTH:1e3,BOMB_CARPET_SIZE:5,BOMB_COOLDOWN:25,BOMB_EXPLOSION_RADIUS:100}},GAME_IMAGES={MAIN_MENU:"img/menu/menu.png",PLANES:{BF109:{SPRITE:["img/planes/bf109/1.png","img/planes/bf109/2.png"],CRASHED:"img/planes/bf109/3.png"},STUKA:{SPRITE:["img/planes/stuka/1.png","img/planes/stuka/2.png"],CRASHED:"img/planes/stuka/3.png"},KI84:{SPRITE:["img/planes/ki84/1.png","img/planes/ki84/2.png"],CRASHED:"img/planes/ki84/3.png"}},LEVELS:{GRASSLAND:"img/levels/grassland.jpg",DESERT:"img/levels/desert.jpg",WINTER:"img/levels/winter.jpg"},PROJECTILES:{BULLET:"img/projectiles/bullet.png",PLANE_BOMB:["img/projectiles/plane-bomb/1.png","img/projectiles/plane-bomb/2.png"],BOMBER_BOMB:["img/projectiles/bomber-bomb/1.png","img/projectiles/bomber-bomb/2.png"]},BULLET_IMPACT:["img/projectiles/bullet-impact/1.png","img/projectiles/bullet-impact/2.png","img/projectiles/bullet-impact/3.png"],EXPLOSION:["img/explosion/1.png","img/explosion/2.png","img/explosion/3.png","img/explosion/4.png","img/explosion/5.png","img/explosion/6.png","img/explosion/7.png","img/explosion/7.png","img/explosion/7.png","img/explosion/7.png","img/explosion/7.png","img/explosion/6.png","img/explosion/6.png","img/explosion/6.png","img/explosion/5.png","img/explosion/5.png","img/explosion/5.png","img/explosion/4.png","img/explosion/4.png","img/explosion/4.png","img/explosion/3.png","img/explosion/3.png","img/explosion/3.png","img/explosion/2.png","img/explosion/2.png","img/explosion/2.png","img/explosion/1.png","img/explosion/1.png","img/explosion/1.png"],BOMB_HOLE:"img/bomb_hole.png",ENEMIES:{B17:{SPRITE:["img/enemies/b17/1.png","img/enemies/b17/2.png"],CRASHED:"img/enemies/b17/3.png"}},CIVILIAN:{SPRITE:["img/civilian/1.png","img/civilian/2.png","img/civilian/3.png","img/civilian/4.png","img/civilian/5.png","img/civilian/6.png","img/civilian/7.png","img/civilian/8.png"],DEAD:"img/civilian/9.png"},HUD:{BOMB_ICON:"img/hud/bomb_icon.png"}},LEVELS_DATA={GRASSLAND:{WEATHER:"normal",CIVILIANS:[{objectType:"Civilian",arguments:{x:1300,y:550}},{objectType:"Civilian",arguments:{x:1350,y:550}},{objectType:"Civilian",arguments:{x:1410,y:550}},{objectType:"Civilian",arguments:{x:1510,y:550}},{objectType:"Civilian",arguments:{x:1540,y:550}},{objectType:"Civilian",arguments:{x:1590,y:550}}],ENEMIES:[{objectType:"Bomber",arguments:{x:1100,y:0}},{objectType:"Bomber",arguments:{x:1800,y:100}},{objectType:"Bomber",arguments:{x:2500,y:150}}]},DESERT:{WEATHER:"normal",CIVILIANS:[],ENEMIES:[{objectType:"Bomber",arguments:{x:700,y:300}},{objectType:"Bomber",arguments:{x:1200,y:400}}]},WINTER:{WEATHER:"snow",CIVILIANS:[],ENEMIES:[{objectType:"Bomber",arguments:{x:700,y:300}},{objectType:"Bomber",arguments:{x:1200,y:400}}]}},PLANE_STATS={BF109:{DAMAGE:60,HEALTH:120,MAX_SPEED:3,CLIMB_SPEED:7,DESCEND_SPEED:7,MACHINEGUN_HEATING:2,MAX_MACHINEGUN_HEAT:100,BOMB_COOLDOWN:200,BOMB_DELAY:20,MAX_BOMBS:2,BOMB_EXPLOSION_RADIUS:50},STUKA:{DAMAGE:90,HEALTH:200,MAX_SPEED:2,CLIMB_SPEED:5,DESCEND_SPEED:15,MACHINEGUN_HEATING:3,MAX_MACHINEGUN_HEAT:250,BOMB_COOLDOWN:100,BOMB_DELAY:10,MAX_BOMBS:4,BOMB_EXPLOSION_RADIUS:70},KI84:{DAMAGE:120,HEALTH:80,MAX_SPEED:4,CLIMB_SPEED:15,DESCEND_SPEED:5,MACHINEGUN_HEATING:2,MAX_MACHINEGUN_HEAT:80,BOMB_COOLDOWN:250,BOMB_DELAY:20,MAX_BOMBS:1,BOMB_EXPLOSION_RADIUS:60}},Utils=new function(){function t(t){return t.left=t.x,t.top=t.y+t.offset,t.right=t.left+t.width,t.bottom=t.top+t.height,t}var i=this;this.intersect=function(i,e){var s=!1;i=t(i),e=t(e);var n=Math.max(0,Math.min(i.right,e.right)-Math.max(i.left,e.left)),h=Math.max(0,Math.min(i.bottom,e.bottom)-Math.max(i.top,e.top));return 0!==n&&0!==h&&(s=!0),s},this.collidesWith=function(t,e){var s=!1;return t.constructor!==Array&&(t=[t]),e.constructor!==Array&&(e=[e]),t.forEach(function(t){e.forEach(function(e){i.intersect(t,e)&&(s=!0)})}),s}},CONSTANTS={GAME_STATE:{MAIN_MENU:0,PLAYING:1,GAME_OVER:2,PAUSED:3}},IMAGE_REPOSITORY=new ImageRepository(GAME_IMAGES,function(){var t=new Menu;t.showMenu(function(t,i){var e=new Game(IMAGE_REPOSITORY.images,PLANE_STATS,ENEMY_STATS,LEVELS_DATA);e.start(t,i)})});